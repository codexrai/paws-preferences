<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Choose your Favorite Meow! üê±</title>
<style>
  :root{
    --card-radius:18px;
    --bg1:#faf5ff;
    --bg2:#f3e8ff;
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    font-family:system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    background: linear-gradient(180deg,var(--bg1),var(--bg2));
    min-height:100vh;
    display:flex;
    justify-content:center;
    align-items:flex-start;
    padding:28px 12px;
  }

  .container{
    width:100%;
    max-width:420px;
    background:transparent;
  }

  header.appbar{
    display:flex;
    align-items:center;
    justify-content:space-between;
    margin-bottom:12px;
  }

  h1{margin:0;font-size:20px}
  .sub{font-size:13px;color:#6b7280;margin-top:4px}

  .collection-btn{
    background:#fff;
    border:0;
    border-radius:999px;
    padding:8px 12px;
    font-weight:600;
    box-shadow:0 6px 14px rgba(2,6,23,.08);
    cursor:pointer;
    display:inline-flex;
    gap:8px;
    align-items:center;
  }

  .deck{
    position:relative;
    width:100%;
    height:520px;
    margin:6px 0 12px;
  }

  .card{
    position:absolute;
    width:100%;
    height:100%;
    border-radius:var(--card-radius);
    overflow:hidden;
    background:#fff;
    box-shadow:0 12px 30px rgba(15,23,42,.12);
    user-select:none;
    touch-action:none;
    display:flex;
    align-items:center;
    justify-content:center;
    transition:transform .22s ease, opacity .22s ease;
  }

  .card img{width:100%;height:100%;object-fit:cover;display:block}

  /* stack visuals */
  .card:nth-child(2){transform:scale(.96) translateY(10px);opacity:.94}
  .card:nth-child(3){transform:scale(.92) translateY(22px);opacity:.88}

  .badge{
    position:absolute;
    top:18px;
    padding:6px 14px;
    font-weight:800;
    border-radius:10px;
    border:3px solid;
    opacity:0;
    background: rgba(255,255,255,0.7);
    font-size:16px;
    letter-spacing:0.04em;
  }
  .badge.like{ right:16px; color:#059669; border-color:#059669 }
  .badge.nope{ left:16px; color:#dc2626; border-color:#dc2626 }

  .controls{
    display:flex;
    justify-content:space-between;
    gap:12px;
    margin-bottom:12px;
  }

  .btn{
    flex:1;
    padding:12px 10px;
    background:#fff;
    border:0;
    border-radius:12px;
    font-size:16px;
    box-shadow:0 8px 18px rgba(2,6,23,.06);
    cursor:pointer;
  }

  .progress{
    text-align:center;
    color:#6b7280;
    margin-bottom:8px;
    font-size:14px;
  }

  /* summary/collection view */
  #collectionView{ display:none; }
  .collection-grid{
    display:grid;
    grid-template-columns:repeat(2,1fr);
    gap:10px;
    max-height:420px;
    overflow:auto;
    padding-right:6px;
  }

  .col-card{
    position:relative;
    border-radius:12px;
    overflow:hidden;
    background:#fff;
    box-shadow:0 10px 20px rgba(2,6,23,.06);
  }
  .col-card img{width:100%;height:160px;object-fit:cover;display:block}
  .remove-btn{
    position:absolute;
    top:8px;
    right:8px;
    background:rgba(255,255,255,.95);
    border:0;
    border-radius:10px;
    padding:6px;
    cursor:pointer;
    box-shadow:0 6px 14px rgba(2,6,23,.06);
    font-weight:700;
  }

  .back-btn{
    margin-top:8px;
    background:#fff;
    border:0;
    padding:10px 14px;
    border-radius:12px;
    cursor:pointer;
    box-shadow:0 6px 12px rgba(2,6,23,.06);
  }

  /* small screens spacing */
  @media (max-width:420px){
    .deck{height:460px}
    .collection-grid .col-card img{height:140px}
  }
</style>
</head>
<body>
  <div class="container">
    <header class="appbar">
      <div>
        <h1>Choose your Favorite Meow! üê±</h1>
        <div class="sub">Swipe right to like ‚Äî left to skip</div>
      </div>
      <div>
        <button id="openCollection" class="collection-btn">Collection üíû (<span id="collectionCount">0</span>)</button>
      </div>
    </header>

    <!-- Swipe View -->
    <main id="swipeView">
      <div class="progress" id="progressText">0 / 0</div>

      <div class="deck" id="deck"></div>

      <div class="controls">
        <button id="noBtn" class="btn">‚ùå Nope</button>
        <button id="likeBtn" class="btn">ü©∑ Like</button>
      </div>
    </main>

    <!-- Collection View -->
    <section id="collectionView">
      <h2>Your cats collection üíû</h2>
      <p id="collectionInfo" class="sub">Scroll to view your favourites. Remove any with ‚ùå</p>
      <div class="collection-grid" id="collectionGrid"></div>
      <div style="display:flex;gap:8px;margin-top:10px;">
        <button id="backBtn" class="back-btn">Back to swiping</button>
        <button id="clearBtn" class="back-btn" style="background:#fee2e2">Clear all</button>
      </div>
    </section>
  </div>

<script>
/* ===== App State ===== */
const TOTAL = 18; // change if you want more/less
let index = 0;
let liked = []; // array of {id, url}
const cats = Array.from({length:TOTAL}, (_,i)=>({
  id: i,
  url: `https://cataas.com/cat?${Date.now()}-${i}-${Math.random().toString(36).slice(2,8)}`
}));

/* ===== DOM refs ===== */
const deck = document.getElementById('deck');
const progressText = document.getElementById('progressText');
const collectionCount = document.getElementById('collectionCount');
const openCollection = document.getElementById('openCollection');
const swipeView = document.getElementById('swipeView');
const collectionView = document.getElementById('collectionView');
const collectionGrid = document.getElementById('collectionGrid');
const likeBtn = document.getElementById('likeBtn');
const noBtn = document.getElementById('noBtn');
const backBtn = document.getElementById('backBtn');
const clearBtn = document.getElementById('clearBtn');

/* ===== Helpers ===== */
function updateCollectionButton(){
  collectionCount.textContent = liked.length;
}

function createCard(cat){
  const card = document.createElement('div');
  card.className = 'card';
  card.dataset.id = cat.id;

  const img = document.createElement('img');
  img.src = cat.url;
  img.alt = 'cute cat';

  const likeBadge = document.createElement('div');
  likeBadge.className = 'badge like';
  likeBadge.textContent = 'LIKE';

  const nopeBadge = document.createElement('div');
  nopeBadge.className = 'badge nope';
  nopeBadge.textContent = 'NOPE';

  card.appendChild(img);
  card.appendChild(likeBadge);
  card.appendChild(nopeBadge);

  return card;
}

function renderDeck(){
  deck.innerHTML = '';
  // show up to 3 cards (top is last element appended)
  cats.slice(index, index+3).reverse().forEach(c=>{
    deck.appendChild(createCard(c));
  });
  progressText.textContent = `${Math.min(index+1, TOTAL)} / ${TOTAL}`;
  attachDrag();
}

/* ===== Drag / Swipe Logic ===== */
function attachDrag(){
  const top = deck.lastElementChild;
  if(!top) return;

  let startX = null;
  let dx = 0;

  const likeBadge = top.querySelector('.like');
  const nopeBadge = top.querySelector('.nope');

  function start(e){
    startX = (e.touches ? e.touches[0] : e).clientX;
    top.style.transition = 'none';
  }

  function move(e){
    if(startX === null) return;
    const clientX = (e.touches ? e.touches[0] : e).clientX;
    dx = clientX - startX;
    const tilt = dx / 15;
    top.style.transform = `translateX(${dx}px) rotate(${tilt}deg)`;

    likeBadge.style.opacity = dx > 0 ? Math.min(dx / 80, 1) : 0;
    nopeBadge.style.opacity = dx < 0 ? Math.min(-dx / 80, 1) : 0;
  }

  function end(){
    if(startX === null) return;
    top.style.transition = 'transform .25s ease-out';
    if(dx > 120) doSwipe('right');
    else if(dx < -120) doSwipe('left');
    else top.style.transform = '';

    startX = null;
    dx = 0;
  }

  // Pointer events (desktop & many touch devices)
  top.onpointerdown = start;
  window.onpointermove = move;
  window.onpointerup = end;

  // Touch fallbacks (some mobiles)
  top.ontouchstart = start;
  window.ontouchmove = move;
  window.ontouchend = end;
}

/* ===== Swipe action ===== */
function doSwipe(dir){
  const card = deck.lastElementChild;
  if(!card) return;
  card.style.transform = `translateX(${dir==='right'?1000:-1000}px) rotate(${dir==='right'?30:-30}deg)`;
  // remove after animation
  setTimeout(()=>{
    if(dir === 'right'){
      liked.push(cats[index]);
      updateCollectionButton();
    }
    index++;
    if(index >= TOTAL){
      // finished - show summary/collection automatically
      showCollection();
    } else {
      renderDeck();
    }
  }, 220);
}

/* ===== Buttons ===== */
likeBtn.addEventListener('click', ()=>doSwipe('right'));
noBtn.addEventListener('click', ()=>doSwipe('left'));

/* ===== Navigation: Views ===== */
openCollection.addEventListener('click', showCollection);
backBtn.addEventListener('click', ()=>{ showSwipe(); });

function showCollection(){
  // render collection cards
  renderCollection();
  swipeView.style.display = 'none';
  collectionView.style.display = 'block';
}

function showSwipe(){
  collectionView.style.display = 'none';
  swipeView.style.display = 'block';
}

/* ===== Collection rendering ===== */
function renderCollection(){
  collectionGrid.innerHTML = '';
  if(liked.length === 0){
    collectionGrid.innerHTML = '<div style="padding:18px;color:#6b7280">No favorites yet ‚Äî swipe some cats! ‚ù§Ô∏è</div>';
    return;
  }

  liked.forEach((c, idx) => {
    const card = document.createElement('div');
    card.className = 'col-card';

    const img = document.createElement('img');
    img.src = c.url;
    img.alt = 'liked cat';

    const remove = document.createElement('button');
    remove.className = 'remove-btn';
    remove.innerText = '‚ùå';
    remove.title = 'Remove from collection';
    remove.addEventListener('click', ()=>{
      // remove this item
      liked.splice(idx, 1);
      updateCollectionButton();
      renderCollection();
    });

    card.appendChild(img);
    card.appendChild(remove);
    collectionGrid.appendChild(card);
  });
}

/* ===== Clear all collection ===== */
clearBtn.addEventListener('click', ()=>{
  if(!confirm('Clear all liked cats from your collection?')) return;
  liked = [];
  updateCollectionButton();
  renderCollection();
});

/* ===== Initial render ===== */
updateCollectionButton();
renderDeck();

/* Optional: make collection button show live count as likes happen */
(function liveCountUpdater(){
  // intercept push via proxies is overkill; instead updateCollectionButton() is called where needed.
  // but also update button when user opens collection or when like happens.
  // The like action above calls updateCollectionButton already.
})();
</script>
</body>
</html>
